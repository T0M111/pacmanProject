name: CI/CT

on:
  push:
    branches: [ main, master, develop ]
  pull_request:
    branches: [ main, master, develop ]
  workflow_dispatch:

jobs:
  build-and-test:
    name: Integración y Prueba Continua
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout código
      uses: actions/checkout@v4
      
    - name: Configurar JDK 17
      uses: actions/setup-java@v4
      with:
        java-version: '17'
        distribution: 'temurin'
        
    - name: Crear directorio bin
      run: mkdir -p bin
      
    - name: Compilar código fuente
      run: javac -d bin src/*.java
      
    - name: Verificar compilación exitosa
      run: |
        if [ -f bin/Game.class ]; then
          echo "✓ Compilación exitosa - Game.class generado"
        else
          echo "✗ Error: Game.class no encontrado"
          exit 1
        fi
        
    - name: Listar archivos compilados
      run: ls -la bin/
      
    - name: Verificar todas las clases compiladas
      run: |
        echo "Verificando clases compiladas..."
        EXPECTED_CLASSES="Game Board Pacman Ghost Direction"
        for class in $EXPECTED_CLASSES; do
          if [ -f "bin/${class}.class" ]; then
            echo "✓ ${class}.class"
          else
            echo "✗ ${class}.class no encontrado"
            exit 1
          fi
        done
        echo "✓ Todas las clases compiladas correctamente"
